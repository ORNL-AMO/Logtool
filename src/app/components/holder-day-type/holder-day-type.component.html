<div style="margin: 0; border: 0; padding:0; width:100%">
    <!-- File Control Panel, calendar, placeholder, help panel -->
    <div class="row" style="height: 260px;">
        <!-- control panel -->
        <div class="col-3 panel col1" style="min-height: 250px;  height:200px; min-width:250px; ">
            <!-- Title -->
            <div class="row">
                <p class="header"> Data Selector</p>
            </div>


            <!--      <div class="row justify-content-center">

                    &lt;!&ndash; data button &ndash;&gt;
                    <div class="col-4 tight-fit">
                      <div class="row justify-content-center"><p class="tight-fit"> Data </p></div>
                      <div class="row justify-content-center">
                        <label>
                          <input type="radio" class="checkmark" checked="checked" name="graph" value="data" [(ngModel)]=shift>
                        </label>
                      </div>
                    </div>

                    &lt;!&ndash; Snapshot button &ndash;&gt;
                    <div class="col-4 tight-fit ">
                      <div class="row justify-content-center"><p class="tight-fit">Snapshot</p></div>
                      <div class="row justify-content-center">
                        <label>
                          <input type="radio" class="checkmark" name="graph" value="snapshot" [(ngModel)]=shift>
                        </label>
                      </div>
                    </div>

                    &lt;!&ndash; File button &ndash;&gt;
                    <div class="col-4 tight-fit">
                      <div class="row justify-content-center"><p class="tight-fit"> File </p></div>
                      <div class="row justify-content-center">
                        <label>
                          <input type="radio" class="checkmark" checked="checked" name="graph" value="file" [(ngModel)]=shift>
                        </label>
                      </div>
                    </div>
                  </div>-->

            <!-- Import New data -->
            <form #formElement="ngForm" *ngIf="shift=='data'" (ngSubmit)="dayTypeNavigation(false)">

                <!-- File select box --->
                <div></div>
                <div class=" row" style="height: 30px; margin: 5px auto 5px auto;">
                    <div class="col-2 tight-fit" style="padding:5px; vertical-align: center; min-width:45px;">
                        <p class="dropbox-label tight-fit" style="text-align: right">File:</p>
                    </div>
                    <div class="col-9 tight-fit" style="margin-top: 5px; margin-right: 5px">
                        <select name="fileSelector" [(ngModel)]="temp5" (click)="fileSelectorEvent($event)"
                                style="width: 100%; ">

                            <option *ngFor="let file of fileSelector" value="{{file.identifier}}">{{file.name}}</option>
                        </select>
                    </div>
                </div>
                <!-- Column select box -->
                <div class="row " style="height: 30px; margin: 5px auto 15px auto;">

                    <div class="col-2 tight-fit" style="padding:5px; vertical-align: center; min-width:45px;">
                        <p class="dropbox-label tight-fit" style="text-align: right">Data:</p>
                    </div>

                    <!--   -->
                    <div class="col-9 tight-fit" style="margin-top: 5px;">

                        <select name="columnSelector" [(ngModel)]="temp6" (click)="columnSelectorEvent($event)">
                            <option *ngFor="let column of columnSelector"
                                    value="{{column.identifier}}">{{column.name}}</option>
                        </select>
                    </div>
                </div>
                <!-- button-->
                <div class="row justify-content-center " style="height:45px; z-index:-1;">

                    <div class="col-8 tight-fit" style="height:100%;">
                        <button class="btn-primary" type="submit" style="height: 100%; width: 100%; z-index:0;">
                            Import
                        </button>
                    </div>
                </div>
            </form>

            <!-- Load snapshot -->
            <!--   <div class="row justify-content-center" style="position: relative;" *ngIf="shift=='snapshot'">
                 &lt;!&ndash; always displayed box &ndash;&gt;
                 <div class="row justify-content-center custombox" id="selected" (click)="showDropDown(true)">

                   <span style="max-height: 10px; width: 100%; text-align: center; font-size: 13px; font-weight: bold;"
                         (click)="$event.stopPropagation(); showDropDown(true)"> {{currentFile}} </span>
                   <h1></h1>
                 </div>

                 &lt;!&ndash; load button &ndash;&gt;
                 <div class="row justify-content-center " style="position: relative; height:45px; ; margin-top: 30px;">
                   <div class="col-8 tight-fit" style="height:100%;">
                     <button class="btn-primary" (click)="$event.stopPropagation(); loadSession(currentId)"
                             style="position: relative; height: 100%; width: 100%;;">LOAD
                     </button>
                   </div>
                 </div>

                 &lt;!&ndash; toggled menu &ndash;&gt;
                 <div class="row holder" id="dropdown" style="position: relative; top: -75px; display: none;"
                      (mouseleave)="showDropDown(false);">
                   <div class="row drop-item" *ngFor="let file of snapShotStash" style="z-index: 6; ">
                     <p class="tight-fit" (click)="idEvent(file)"
                        style="height: 20px; width: 160px; padding-left: 5px; z-index: 6;">{{file.displayName}}:</p>

                     <span class="tight-fit delete" (click)="$event.stopPropagation(); deleteSession(file.id)"
                           style="height: 20px; width: 20px; text-align: center;  z-index: 6;">X</span>
                   </div>
                 </div>
               </div>-->

            <!--<div *ngIf="shift=='file'">
              <div class="row justify-content-center">
                <button class="btn" style="width: 178px; margin-bottom: 10px;" (click)="exportToFile()">Export To File</button>
              </div>
              <div class="row justify-content-center">
                <button class="btn" style="width: 178px;" (click)="importFile()">Import from File</button>
              </div>
            </div>-->

        </div>

        <!-- calendar panel -->
        <div class="col-5">
            <app-calendar style="width: 100%"
                          (selectionToggle)="selectionToggle($event)"
                          (binShift)="shiftBins($event)"
                          (clearSelection)="clearSelection()"></app-calendar>
        </div>


        <!-- averages -->
        <div id="averages" class="col-2 panel tight-fit" style="height:250px; margin:5px 10px 5px 5px;">
            <div class="row">
                <p class="header"> Averages</p>
            </div>
            <!-- day averages -->
            <div class="row" *ngIf="showBinMode">
                <div class="col">
                    <p class="tight-fit" style="text-align: center">Daily Averages:</p>
                    <div id='avg' *ngIf="globalYAverageDay!==undefined && globalYAverageDay.length > 0"
                         style="overflow: auto; max-height: 175px; border: 1px solid black"
                         (mousedown)="$event.stopPropagation(); startDrag($event, 'avg');"
                         (mouseup)="$event.stopPropagation(); endDrag($event);"
                         (mouseleave)="$event.stopPropagation(); endDrag($event);"
                         (mousemove)="$event.stopPropagation(); drag($event, 'Y')">
                        <ul class="tight-fit">

                            <li class="row tight-fit" *ngFor="let day of globalYAverageDay"
                                style="border: 1px solid black;">
                                <div class="col-6" style="border-right: 1px solid black;"
                                     [style.background]="day.stroke !== 1 ? day.color: 'blanchedalmond' "
                                     [style.color]="day.stroke !== 1 ? 'white': 'black' ">
                                    <p class="list tight-fit">{{day.name}}</p>
                                </div>
                                <div class="col-6"
                                     [style.background]="day.stroke !== 1 ? day.color: 'blanchedalmond' "
                                     [style.color]="day.stroke !== 1 ? 'white': 'black' ">
                                    <p class="list tight-fit">{{day.value|number:'1.0-2'}}</p>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- bin averages-->
            <div class="row" *ngIf="!showBinMode">
                <div class="col">
                    <p class="tight-fit" style="text-align: center">Day Type Averages:</p>
                    <div id='avg2' *ngIf="globalYAverageDay!==undefined && globalYAverageBin.length > 0"
                         style="overflow: auto; max-height: 135px; border: 1px solid black"
                         (mousedown)="$event.stopPropagation(); startDrag($event, 'avg2');"
                         (mouseup)="$event.stopPropagation(); endDrag($event);"
                         (mouseleave)="$event.stopPropagation(); endDrag($event);"
                         (mousemove)="$event.stopPropagation(); drag($event, 'Y')">
                        <ul class="tight-fit">
                            <li class="row tight-fit" *ngFor="let day of globalYAverageBin"
                                style="border: 1px solid black; background:blanchedalmond;"
                                [ngStyle]="{'border':day.value != 0 ? '1px solid black' : 'none' }">
                                <div class="col-6" *ngIf="day.value != 0" style="border-right: 1px solid black;">
                                    <p class="list tight-fit">{{day.name}}</p>
                                </div>
                                <div class="col-6" *ngIf="day.value != 0">
                                    <p class="list tight-fit">{{day.value|number:'1.0-2'}}</p>
                                </div>
                            </li>

                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- help -->
        <div class="col panel tight-fit" style="height: 250px; max-width:100%;margin-right: 25px; margin-top:5px">
            <div>
                <div class="row justify-content-between header">
                    <span class="col-1 panel-title" style="width:100%">Reports</span>
                    <div class="col-5"></div>
                    <button id="generate_report" class="btn-primary" style="alignment: center" [popover]="pop2">Generate
                        Report
                    </button>
                </div>
                <div class="list-container" style="margin-top:0; max-height: 15vh;">
                    <div class="row test tight-fit justify-content-center" *ngFor="let file of dayTypeReportList"
                         style="border-bottom: 1px solid black; border-top: 1px solid black"
                         [ngStyle]="{'background' : file.selected ? 'blue': '',
                           'color' : file.selected ? 'white': ''}">
                        <div class="tight-fit nonSelectable col-11" (click)="routeToDayType(file)">
                            <p class="tight-fit" style="text-align: center;">{{file.name}}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- bin control and graphs -->
    <div id="row2" class="row row2">

        <!-- bin control container -->
        <div id="bin-panel" class="panel" style="max-width:250px; min-width:250px; max-height: 670px">
            <!-- header-->
            <div class="inner-row justify-content-center" style="min-height: 25px;">
                <p class="header" style="text-align: center"> Day Types </p>
            </div>

            <!-- bins -->
            <!-- Normal Bins -->
            <div class="row list-items"
                 style="max-height: 650px; width:90%; overflow-y: auto; box-shadow: none; margin: 0 auto 0 auto;">
                <div id="types" class="tight-fit"
                     style="max-height: 555px; width:100%; overflow-y: auto; box-shadow: none; margin: 0 auto 0 auto;"
                     (mousedown)="$event.stopPropagation(); startDrag($event,'types');"
                     (mouseup)="$event.stopPropagation(); endDrag($event);"
                     (mouseleave)="$event.stopPropagation(); endDrag($event);"
                     (mousemove)="$event.stopPropagation(); drag($event, 'Y');">
                    <div class="row justify-content-center" style=" background:darkgray;"
                         *ngFor="let bin of binList let i = index ">
                        <app-day-type-bin
                                [name]=bin.binName
                                [color]="bin.binColor"
                                [activeContents]="selectedBinList[i]"
                                (toggle_change)="binToggled($event)"
                                (removeTypeOutput)="removeBin($event)"
                                style="width:95%; height:90%; margin: 1.5% 2.5% 1% 2.5%">>
                        </app-day-type-bin>
                    </div>
                </div>
            </div>
            <!-- Add Type -->
            <div class="row" style="width:90%; margin: auto;">
                <div class="row justify-content-center" style="background:darkgray; width:100%;">
                    <app-day-type-bin
                            [name]='"add"'
                            [color]='"black"'
                            (addTypeOutput)="showBinMod(template)"
                            style="width:95%; margin: 2.5%;">
                    </app-day-type-bin>
                </div>
            </div>


            <!-- Option buttons -->
            <div class="row justify-content-center tight-fit">
                <div class="col-4 tight-fit">
                    <div class="row justify-content-center tight-fit">
                        <button class="btn-primary" style="width: 100%" (click)="resetBins()">Reset</button>
                    </div>
                </div>
                <div class="col-4 tight-fit">
                    <div class="row justify-content-center tight-fit">
                        <button class="btn-primary" style="width: 100%" (click)="clearBins()">Clear</button>
                    </div>
                </div>
                <div class="col-4 tight-fit">
                    <div class="row justify-content-center tight-fit">
                        <button id="save_btn" class="btn-primary" style="width: 100%" [popover]="pop">Save</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- graph holder -->
        <div class=" col panel" id="myDiv" style="height:490px; margin-right:25px;">
            <div class="row">
                <div class="col">
                    <select name="plotBox" style="width: 150px;" (click)=plotShift($event);>
                        <option value="day">Day Averages</option>
                        <option value="bin">Bin Averages</option>
                    </select>
                </div>
            </div>
            <div [hidden]="!showBinMode">
                <plotly-plot [data]="graphDayAverage.data" [layout]="graphDayAverage.layout"
                             [config]="graphDayAverage.config"
                             (click)="clickAnnotationDayAverage($event)"
                             (relayout)="calculatePlotStatsDay()"></plotly-plot>
            </div>

            <div [hidden]="showBinMode">
                <plotly-plot [data]="graphBinAverage.data" [layout]="graphBinAverage.layout"
                             [config]="graphBinAverage.config"
                             (click)="clickAnnotationBinAverage($event)"
                             (relayout)="calculatePlotStatsBin()"></plotly-plot>
            </div>
        </div>
    </div>

    <!-- table panel-->
    <div class="row" style="margin-top:10px">
        <div class="col-sm-3 panel" style=" visibility: hidden; max-width:250px; min-height: 50px">Placeholder</div>
        <!-- table container-->
        <div id="table" class="col panel" style="min-height: 50px; margin-right:25px">
            <div style="width: 96% ;  margin:5px auto 0px 1465px ;">
                <button class="btn-primary" style="" (click)="exportBinAverageData()">Export</button>
            </div>
            <div style="width: 96% ;  margin:5px auto 2px auto ;">
                <div style="min-width: 96%; margin:auto;">
                    <p *ngIf="sumArray.length < 1;" class="tight-fit"
                       style="border: 1px solid black; text-align: center; min-width: 100%; margin:auto;">Channel
                        Name</p>
                </div>
                <div *ngFor="let thing of sumArray" style="min-width: 96%; margin:auto;">
                    <p *ngIf="thing.length > 0;" class="tight-fit"
                       style="border: 1px solid black; text-align: center; min-width: 100%; margin:auto;">{{thing[0].channelName}}</p>
                </div>
            </div>
            <!-- table -->
            <div id="tablescroll" style="width: 96% ; overflow: auto; margin: 0 auto 10px auto; max-height: 125px"
                 (mousedown)="$event.stopPropagation(); startDrag($event, 'tablescroll');"
                 (mouseup)="$event.stopPropagation(); endDrag($event);"
                 (mouseleave)="$event.stopPropagation(); endDrag($event);"
                 (mousemove)="$event.stopPropagation(); drag($event, 'Y')">
                <!-- Populated table -->
                <table style="width: 100%; margin:auto;">
                    <tr>
                        <th style="min-width: 14%; border: 1px solid black; text-align: center">Entries</th>
                        <th style="min-width: 14%; border: 1px solid black; text-align: center">Day Type</th>
                        <th *ngFor="let item of [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]"
                            style=" min-height: 25px; width: 3%; border: 1px solid black; text-align: center;"
                            class="tight-fit">{{item}}</th>
                    </tr>
                    <tr *ngFor="let entry of sumArray[0] let i= index">
                        <td style="min-width: 12%; border: 1px solid black; text-align: center">{{entry.entries}}</td>
                        <td [ngStyle]="{'background': entry.binColor}"
                            style="min-width: 12%; border: 1px solid black; color: white; text-align: center">{{entry.binValue}}</td>
                        <td class="table-item"
                            *ngFor="let item of [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]"
                            style=" min-height: 25px; width: 3%; border: 1px solid black; text-align: center; font-size: 8pt;"
                        >{{entry.averageValue[item] === null || undefined ? '0.00' : entry.averageValue[item]}} </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</div>

<ng-template #pop id="bob">
    <div style="width:200px; height:100px">
        <div class="row justify-content-end" style="height: 10px; margin-bottom: 10px;">
            <span class="close pull-right" style="padding: 0;" aria-hidden="true" (click)="hideSave()">&times;</span>
        </div>
        <div class="row justify-content-center">
            <input type="text" style="width:190px; text-align: center; height:20px; margin:auto 5px 5px 5px;"
                   [(ngModel)]="sesName" placeholder="type session name here">
        </div>
        <div class="row justify-content-center">
            <button class="btn-primary" style="width:190px; height:30px; font-size:14px; vertical-align: middle;"
                    (click)="saveSession()">Confirm
            </button>
        </div>
    </div>
</ng-template>

<ng-template #pop2 id="bob2">
    <div style="width:200px; height:100px">
        <div class="row justify-content-end" style="height: 10px; margin-bottom: 10px;">
            <span class="close pull-right" style="padding: 0;" aria-hidden="true" (click)="hideReport()">&times;</span>
        </div>
        <div class="row justify-content-center">
            <input type="text" style="width:190px; text-align: center; height:20px; margin:auto 5px 5px 5px;"
                   [(ngModel)]="reportName" placeholder="Report Name">
        </div>
        <div class="row justify-content-center">
            <button class="btn-primary" style="width:190px; height:30px; font-size:14px; vertical-align: middle;"
                    (click)="generateReport()">Confirm
            </button>
        </div>

    </div>
</ng-template>

<!-- Add Bin Module -->
<ng-template #template>
    <div class="modal-header">
        <h4 class="modal-title pull-left">Add a Type Bin</h4>
        <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="row justify-content-center" style="margin-left: 5px;">
        <div class="col tight-fit"><p>New Bin Name: </p></div>
        <div class="col tight-fit">
            <label>
                <input [(ngModel)]="newBinName">
            </label>
        </div>
        <div class="col">
            <button style="width: 100%; height:100%" (click)="addBinType()"> Add Bin</button>
        </div>
    </div>

    <div class="row justify-content-center" style="margin-left: 5px;">
        <div class="col tight-fit"><p>New Bin Color: </p></div>
        <div class="col tight-fit">
            <label>
                <input list="colors" [(ngModel)]="newBinColor">
                <datalist id="colors">
                    <option *ngFor="let color of
          ['AliceBlue','AntiqueWhite','Aqua','Aquamarine','Azure','Beige','Bisque','Black','BlanchedAlmond',
          'Blue','BlueViolet','Brown','BurlyWood','CadetBlue','Chartreuse','Chocolate','Coral','CornflowerBlue',
          'Cornsilk','Crimson','Cyan','DarkBlue','DarkCyan','DarkGoldenRod','DarkGray','DarkGrey','DarkGreen',
          'DarkKhaki','DarkMagenta','DarkOliveGreen','Darkorange','DarkOrchid','DarkRed','DarkSalmon','DarkSeaGreen',
          'DarkSlateBlue','DarkSlateGray','DarkSlateGrey','DarkTurquoise','DarkViolet','DeepPink','DeepSkyBlue',
          'DimGray','DimGrey','DodgerBlue','FireBrick','FloralWhite','ForestGreen','Fuchsia','Gainsboro','GhostWhite',
          'Gold','GoldenRod','Gray','Grey','Green','GreenYellow','HoneyDew','HotPink','IndianRed','Indigo','Ivory',
          'Khaki','Lavender','LavenderBlush','LawnGreen','LemonChiffon','LightBlue','LightCoral','LightCyan',
          'LightGoldenRodYellow','LightGray','LightGrey','LightGreen','LightPink','LightSalmon','LightSeaGreen',
          'LightSkyBlue','LightSlateGray','LightSlateGrey','LightSteelBlue','LightYellow','Lime','LimeGreen','Linen',
          'Magenta','Maroon','MediumAquaMarine','MediumBlue','MediumOrchid','MediumPurple','MediumSeaGreen',
          'MediumSlateBlue','MediumSpringGreen','MediumTurquoise','MediumVioletRed','MidnightBlue','MintCream',
          'MistyRose','Moccasin','NavajoWhite','Navy','OldLace','Olive','OliveDrab','Orange','OrangeRed','Orchid',
          'PaleGoldenRod','PaleGreen','PaleTurquoise','PaleVioletRed','PapayaWhip','PeachPuff','Peru','Pink','Plum',
          'PowderBlue','Purple','Red','RosyBrown','RoyalBlue','SaddleBrown','Salmon','SandyBrown','SeaGreen','SeaShell',
          'Sienna','Silver','SkyBlue','SlateBlue','SlateGray','SlateGrey','Snow','SpringGreen','SteelBlue','Tan','Teal',
          'Thistle','Tomato','Turquoise','Violet','Wheat','White','WhiteSmoke','Yellow','YellowGreen']"
                            value={{color}}></option>
                </datalist>


            </label>
        </div>
        <div class="col"></div>
    </div>

</ng-template>
